id: Test XDR Playbook general commands
version: -1
name: Test XDR Playbook general commands
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 4f305e10-332d-474f-8308-8ede620adbb1
    type: start
    task:
      id: 4f305e10-332d-474f-8308-8ede620adbb1
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "59"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: bbb0176d-feff-412d-8bf4-d9006cf737cc
    type: regular
    task:
      id: bbb0176d-feff-412d-8bf4-d9006cf737cc
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 2a3369df-caa4-400b-8a38-fba6edf6236e
    type: regular
    task:
      id: 2a3369df-caa4-400b-8a38-fba6edf6236e
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      gte_creation_time:
        simple: 2010-10-10T00:00:00
      limit:
        simple: "3"
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 147366aa-4523-419a-891c-0073c0905a46
    type: condition
    task:
      id: 147366aa-4523-419a-891c-0073c0905a46
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "4"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.xdr_url
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 8ee7ca46-2ca3-459e-855d-a750cfb22a05
    type: regular
    task:
      id: 8ee7ca46-2ca3-459e-855d-a750cfb22a05
      version: -1
      name: xdr-get-incident-extra-data
      description: xdr-get-incident-extra-data
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: b4c7eece-ed26-4325-82cc-e3c17512bb7e
    type: condition
    task:
      id: b4c7eece-ed26-4325-82cc-e3c17512bb7e
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 9ee8f84f-9b5d-408d-8242-38e0feaae60f
    type: regular
    task:
      id: 9ee8f84f-9b5d-408d-8242-38e0feaae60f
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
      manual_severity:
        simple: HIGH
      status:
        simple: UNDER_INVESTIGATION
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 9e850b5d-9ddb-423d-87f9-df9165b6a7e9
    type: regular
    task:
      id: 9e850b5d-9ddb-423d-87f9-df9165b6a7e9
      version: -1
      name: Save incident id
      description: Save incident id
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      key:
        simple: XDRIncidentID
      value:
        complex:
          root: PaloAltoNetworksXDR
          accessor: Incident.incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: dc2d17df-9538-42c6-82ea-2397e4318733
    type: regular
    task:
      id: dc2d17df-9538-42c6-82ea-2397e4318733
      version: -1
      name: DeleteContext
      description: DeleteContext
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      all:
        simple: "yes"
      keysToKeep:
        simple: XDRIncidentID
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 54e6bba2-8d43-4e9e-8d56-157129c1aca0
    type: regular
    task:
      id: 54e6bba2-8d43-4e9e-8d56-157129c1aca0
      version: -1
      name: xdr-get-incidents
      description: xdr-get-incidents
      script: '|||xdr-get-incidents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      incident_id_list:
        simple: ${XDRIncidentID}
      sort_by_creation_time:
        simple: desc
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 88c4116a-61e8-4186-8a91-2b7ea153a126
    type: condition
    task:
      id: 88c4116a-61e8-4186-8a91-2b7ea153a126
      version: -1
      name: Verify updated values
      description: Verify updated values
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "87"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.severity
            iscontext: true
          right:
            value:
              simple: high
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
          right:
            value:
              simple: under_investigation
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 17a4bf10-1209-43d4-8be4-2ef8dd57c9a9
    type: regular
    task:
      id: 17a4bf10-1209-43d4-8be4-2ef8dd57c9a9
      version: -1
      name: xdr-update-incident
      description: xdr-update-incident
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
      manual_severity:
        simple: LOW
      status:
        simple: NEW
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: 7fd0c0a5-71f5-4527-8b68-3dba6e776b9b
    type: regular
    task:
      id: 7fd0c0a5-71f5-4527-8b68-3dba6e776b9b
      version: -1
      name: xdr-insert-parsed-alert
      description: xdr-insert-parsed-alert
      script: '|||xdr-insert-parsed-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      alert_description:
        simple: This alert from content  TestXDRPlaybook description
      alert_name:
        simple: This alert from content  TestXDRPlaybook
      local_ip:
        simple: 196.168.0.111
      local_port:
        simple: "2000"
      product:
        simple: SandBlast
      remote_ip:
        simple: 2.2.2.2
      remote_port:
        simple: "6000"
      severity:
        simple: High
      vendor:
        simple: Checkpoint
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 08634475-0e45-476f-86af-be77e6dd8cb8
    type: regular
    task:
      id: 08634475-0e45-476f-86af-be77e6dd8cb8
      version: -1
      name: Set 2 CEF alerts to context
      description: Set 2 CEF alerts to context
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: cef_alerts
      value:
        simple: |-
          [
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|microsoft-ds|Unknown|act=AcceptdeviceDirection=0 rt=1569477512000 spt=56957 dpt=445 cs2Label=Rule Name cs2=ADPrimery layer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=1806 parent_rule=0rule_action=Accept rule_uid=8e45f36b-d106-4d81-a1f0-9d1ed9a6be5c ifname=bond2logid=0 loguid={0x5d8c5388,0x61,0x29321fac,0xc0000022} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=363 version=5dst=1.1.1.1 inzone=External outzone=Internal product=VPN-1 & FireWall-1 proto=6service_id=microsoft-ds src=1.1.1.1",
                      "CEF:0|Check Point|VPN-1 & FireWall-1|Check Point|Log|Log|Unknown|act=AcceptdeviceDirection=0 rt=1569477501000 spt=63088 dpt=5985 cs2Label=Rule Namelayer_name=FW_Device_blackened Securitylayer_uuid=07693fc7-1a5c-4f31-8afe-77ae96c71b8c match_id=8899 parent_rule=0rule_action=Accept rule_uid=ae987933-82c0-470f-ab1c-1ad552c82369conn_direction=Internal ifname=bond1.12 logid=0loguid={0x5d8c537d,0xbb,0x29321fac,0xc0000014} origin=1.1.1.1originsicname=CN=DWdeviceBlackend,O=Blackend sequencenum=899 version=5dst=1.1.1.1 product=VPN-1 & FireWall-1 proto=6 src=1.1.1.1"
                  ]
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4745
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 8d1a6114-7123-4b23-85d7-7161b29facef
    type: regular
    task:
      id: 8d1a6114-7123-4b23-85d7-7161b29facef
      version: -1
      name: xdr-insert-cef-alerts
      description: xdr-insert-cef-alerts
      script: '|||xdr-insert-cef-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      cef_alerts:
        simple: ${cef_alerts}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 986a1ed7-4d5b-42cc-8f1d-3586921f6518
    type: regular
    task:
      id: 986a1ed7-4d5b-42cc-8f1d-3586921f6518
      version: -1
      name: Get Endpoint aeec6a2cc92e46fab3b6f621722e9916
      description: Gets a list of endpoints, according to the passed filters. Filtering
        by multiple fields will be concatenated using AND condition (OR is not supported).
        Maximum result set size is 100. Offset is the zero-based number of endpoint
        from the start of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5095
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 3f2f8190-dd0e-4bee-80ca-4492681566dc
    type: condition
    task:
      id: 3f2f8190-dd0e-4bee-80ca-4492681566dc
      version: -1
      name: To isolate ?
      description: To isolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_UNISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5270
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: c81b152a-babf-4b62-85a7-c3e2f0612777
    type: condition
    task:
      id: c81b152a-babf-4b62-85a7-c3e2f0612777
      version: -1
      name: To unisolate?
      description: To unisolate
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "22"
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.is_isolated
            iscontext: true
          right:
            value:
              simple: AGENT_ISOLATED
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 50,
          "y": 5445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 0ff4ee20-a7f6-4f3c-8353-6d8f5ea48fca
    type: regular
    task:
      id: 0ff4ee20-a7f6-4f3c-8353-6d8f5ea48fca
      version: -1
      name: xdr-endpoint-unisolate
      description: Reverses the isolation of an endpoint.
      script: '|||xdr-endpoint-unisolate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      endpoint_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b30dc390-7796-4710-8043-854e0d4db2c0
    type: regular
    task:
      id: b30dc390-7796-4710-8043-854e0d4db2c0
      version: -1
      name: xdr-endpoint-isolate
      description: Isolates the specified endpoint.
      script: '|||xdr-endpoint-isolate'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      endpoint_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 592.5,
          "y": 5620
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: fb6044d3-25bf-4688-8bdc-df6a505c83bc
    type: regular
    task:
      id: fb6044d3-25bf-4688-8bdc-df6a505c83bc
      version: -1
      name: xdr-get-endpoints
      description: xdr-get-endpoints
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      hostname:
        simple: DESKTOP-S2455R8
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: d59800e8-2226-4f86-870a-3a77c5f4258d
    type: condition
    task:
      id: d59800e8-2226-4f86-870a-3a77c5f4258d
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "54"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
            iscontext: true
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.os_type
            iscontext: true
          right:
            value:
              simple: AGENT_OS_WINDOWS
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Endpoint.ip
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: aed173c3-5a68-4713-8dee-ddb47725f103
    type: title
    task:
      id: aed173c3-5a68-4713-8dee-ddb47725f103
      version: -1
      name: Isolation done
      description: Isolation done
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 5795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 605ca76d-f08d-49d8-8d12-81502d6c6fc3
    type: title
    task:
      id: 605ca76d-f08d-49d8-8d12-81502d6c6fc3
      version: -1
      name: Success!
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 2269cc1a-1634-4427-8515-2d5279630dbb
    type: condition
    task:
      id: 2269cc1a-1634-4427-8515-2d5279630dbb
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "62"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptCode
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: e0f3b23a-7ac2-443a-8056-839774a8711a
    type: regular
    task:
      id: e0f3b23a-7ac2-443a-8056-839774a8711a
      version: -1
      name: xdr-get-script-code
      description: Gets the code of a specific script in the script library.
      script: '|||xdr-get-script-code'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 7efc7bf1-8c30-443c-8db8-3a80fb4cc47d
    type: condition
    task:
      id: 7efc7bf1-8c30-443c-8db8-3a80fb4cc47d
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "31"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.ScriptMetadata
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 10565c44-0e51-4050-823b-52226244efe4
    type: regular
    task:
      id: 10565c44-0e51-4050-823b-52226244efe4
      version: -1
      name: xdr-get-script-metadata
      description: Gets the full definition of a specific script in the scripts library.
      script: '|||xdr-get-script-metadata'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      script_uid:
        complex:
          root: PaloAltoNetworksXDR.Scripts
          accessor: script_uid
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 2e55bae8-46a3-432f-8345-bb8a51e4db2b
    type: condition
    task:
      id: 2e55bae8-46a3-432f-8345-bb8a51e4db2b
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Scripts
                accessor: script_uid
                transformers:
                - operator: FirstArrayElement
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 78d65328-1b0d-4517-8ed6-5dd63ddf1118
    type: regular
    task:
      id: 78d65328-1b0d-4517-8ed6-5dd63ddf1118
      version: -1
      name: xdr-get-scripts
      description: Gets a list of scripts available in the scripts library.
      script: '|||xdr-get-scripts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 65baad53-019d-415a-8e21-f14dd97152ec
    type: condition
    task:
      id: 65baad53-019d-415a-8e21-f14dd97152ec
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.EndpointViolations
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: f83b6633-1dc5-49e4-8ca2-6a1a47505457
    type: regular
    task:
      id: f83b6633-1dc5-49e4-8ca2-6a1a47505457
      version: -1
      name: xdr-get-endpoint-device-control-violations
      description: Gets a list of device control violations filtered by selected fields.
        You can retrieve up to 100 violations.
      script: '|||xdr-get-endpoint-device-control-violations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 9090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 424786f8-14a3-4ac1-824d-c79b697c3cc2
    type: condition
    task:
      id: 424786f8-14a3-4ac1-824d-c79b697c3cc2
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Policy.policy_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 2024ca71-5835-4bd8-8850-219a36d38fe1
    type: regular
    task:
      id: 2024ca71-5835-4bd8-8850-219a36d38fe1
      version: -1
      name: xdr-get-policy
      description: Gets the policy name for a specific endpoint.
      script: '|||xdr-get-policy'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      endpoint_id:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 4ff086a7-1bd6-43fd-8389-298c3048a34a
    type: condition
    task:
      id: 4ff086a7-1bd6-43fd-8389-298c3048a34a
      version: -1
      name: Check the number of endpoints in context
      description: Check the number of endpoints in context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "39"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR
                accessor: Endpoint
                transformers:
                - operator: count
            iscontext: true
          right:
            value:
              simple: "1"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: d3870dc1-aa1d-49a1-88ea-ab4cd0726747
    type: regular
    task:
      id: d3870dc1-aa1d-49a1-88ea-ab4cd0726747
      version: -1
      name: xdr-get-endpoints
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 8b15972b-52f8-4463-8873-d109c5c32d48
    type: condition
    task:
      id: 8b15972b-52f8-4463-8873-d109c5c32d48
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "42"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTNAME
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditAgentReports.ENDPOINTID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: Endpoint.ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 68aca4c1-18ce-43f6-89c6-00785743e410
    type: regular
    task:
      id: 68aca4c1-18ce-43f6-89c6-00785743e410
      version: -1
      name: xdr-get-audit-agent-reports
      description: xdr-get-audit-agent-reports
      script: '|||xdr-get-audit-agent-reports'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      limit:
        simple: "5"
      retry-count:
        simple: "3"
      retry-interval:
        simple: "30"
      sort_by:
        simple: category
      sort_order:
        simple: desc
      timestamp_gte:
        simple: "2019-10-10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 8040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: ef9fc55a-da66-4ee5-86f4-394b371e3fc1
    type: condition
    task:
      id: ef9fc55a-da66-4ee5-86f4-394b371e3fc1
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ENTITY_SUBTYPE
            iscontext: true
          right:
            value:
              simple: Authentication failed
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.AuditManagementLogs.AUDIT_ID
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "46":
    id: "46"
    taskid: de4f47d9-447b-48ba-80b8-0c7a42328e8a
    type: regular
    task:
      id: de4f47d9-447b-48ba-80b8-0c7a42328e8a
      version: -1
      name: xdr-get-audit-management-logs
      description: xdr-get-audit-management-logs
      script: '|||xdr-get-audit-management-logs'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      limit:
        simple: "5"
      sort_by:
        simple: sub_type
      sort_order:
        simple: asc
      sub_type:
        simple: Authentication failed
      timestamp_gte:
        simple: "0"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: e41f4418-e23f-4017-8508-e60007182f92
    type: condition
    task:
      id: e41f4418-e23f-4017-8508-e60007182f92
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "46"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.url
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7515
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: bf31c98e-7835-43c1-8314-b5fa29f22004
    type: regular
    task:
      id: bf31c98e-7835-43c1-8314-b5fa29f22004
      version: -1
      name: xdr-get-distribution-url
      description: xdr-get-distribution-url
      script: '|||xdr-get-distribution-url'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      distribution_id:
        simple: 2c74c11b63074653aa01d575a82bf52a
      package_type:
        simple: sh
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 5526cd83-1360-4ed1-8a70-3cc14295828d
    type: condition
    task:
      id: 5526cd83-1360-4ed1-8a70-3cc14295828d
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "48"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: Completed
        - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.status
            iscontext: true
          right:
            value:
              simple: In Progress
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 7165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: f8d919c0-e69e-476d-8500-157a06408eb1
    type: regular
    task:
      id: f8d919c0-e69e-476d-8500-157a06408eb1
      version: -1
      name: xdr-get-create-distribution-status
      description: xdr-get-create-distribution-status
      script: '|||xdr-get-create-distribution-status'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      distribution_ids:
        simple: ${PaloAltoNetworksXDR.Distribution.id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 74f6dde6-f8e7-40d0-8e93-c9802bda736a
    type: condition
    task:
      id: 74f6dde6-f8e7-40d0-8e93-c9802bda736a
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.Distribution.platform
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 108ffcfb-a8df-41d7-826b-8abccbb5b52c
    type: regular
    task:
      id: 108ffcfb-a8df-41d7-826b-8abccbb5b52c
      version: -1
      name: xdr-create-distribution
      description: xdr-create-distribution
      script: '|||xdr-create-distribution'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      agent_version:
        complex:
          root: PaloAltoNetworksXDR
          accessor: DistributionVersions.linux
          transformers:
          - operator: FirstArrayElement
      description:
        simple: Created by TestXDRPlaybook
      name:
        simple: This is test distribution
      package_type:
        simple: standalone
      platform:
        simple: linux
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 2f225bea-273d-4cf7-839c-d3581e9135eb
    type: condition
    task:
      id: 2f225bea-273d-4cf7-839c-d3581e9135eb
      version: -1
      name: Verify Outputs
      description: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "52"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.windows
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.DistributionVersions.linux
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6465
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 10453dcb-cd2a-465f-8fd6-44762e5cfbc4
    type: regular
    task:
      id: 10453dcb-cd2a-465f-8fd6-44762e5cfbc4
      version: -1
      name: xdr-get-distribution-versions
      description: xdr-get-distribution-versions
      script: '|||xdr-get-distribution-versions'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 6290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: b7a4e802-8af4-4528-8b87-9bf76ed68feb
    type: regular
    task:
      id: b7a4e802-8af4-4528-8b87-9bf76ed68feb
      version: -1
      name: xdr-get-contributing-event
      description: Retrieves contributing events for a specific alert.
      script: '|||xdr-get-contributing-event'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      alert_ids:
        complex:
          root: PaloAltoNetworksXDR.Alert
          accessor: internal_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: c2ccc7cf-438f-43bb-815a-162f45d4ec0b
    type: condition
    task:
      id: c2ccc7cf-438f-43bb-815a-162f45d4ec0b
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ContributingEvent
                accessor: alertID
            iscontext: true
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.ContributingEvent
                accessor: events
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 152.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 10038a0e-ca6b-475c-8b33-11057c43d9da
    type: regular
    task:
      id: 10038a0e-ca6b-475c-8b33-11057c43d9da
      version: -1
      name: xdr-replace-featured-field
      description: Replace the featured hosts\users\ips\active-directory_groups listed
        in your environment.
      script: '|||xdr-replace-featured-field'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "58"
    scriptarguments:
      comments:
        simple: This is a test comment
      field_type:
        simple: ip_addresses
      values:
        simple: 1.1.1.1
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: e7def894-04a6-4a3c-8446-16afd5945d49
    type: condition
    task:
      id: e7def894-04a6-4a3c-8446-16afd5945d49
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.FeaturedField
                accessor: fieldType
            iscontext: true
          right:
            value:
              simple: ip_addresses
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.FeaturedField.fields
                accessor: value
            iscontext: true
          right:
            value:
              simple: 1.1.1.1
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 242c01cd-dddc-4380-836d-8ae5e9376291
    type: regular
    task:
      id: 242c01cd-dddc-4380-836d-8ae5e9376291
      version: -1
      name: DeleteContext
      description: DeleteContext
      script: DeleteContext
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "81"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 9164a2ff-fe82-4e66-84a2-7580693c2355
    type: regular
    task:
      id: 9164a2ff-fe82-4e66-84a2-7580693c2355
      version: -1
      name: Get endpoint
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 094b46fc-cb8a-4b4a-88f4-fcf6ec8834a0
    type: regular
    task:
      id: 094b46fc-cb8a-4b4a-88f4-fcf6ec8834a0
      version: -1
      name: Save original alias name
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    scriptarguments:
      key:
        simple: old_name
      value:
        complex:
          root: PaloAltoNetworksXDR.Endpoint
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                iscontext: true
              right:
                value:
                  simple: aeec6a2cc92e46fab3b6f621722e9916
          accessor: alias
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: 8ef8f564-bea0-41fa-8171-cf17c4a492f0
    type: regular
    task:
      id: 8ef8f564-bea0-41fa-8171-cf17c4a492f0
      version: -1
      name: Delete context
      description: |-
        Delete field from context.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 10490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: d22e8fee-98a0-413b-8c82-e029e0b7f8c6
    type: regular
    task:
      id: d22e8fee-98a0-413b-8c82-e029e0b7f8c6
      version: -1
      name: Change alias name
      description: Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        the AND condition (OR is not supported).
      script: '|||xdr-endpoint-alias-change'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      new_alias_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 7cfc65ee-d1d5-46a5-88d3-6bb64cdee41c
    type: condition
    task:
      id: 7cfc65ee-d1d5-46a5-88d3-6bb64cdee41c
      version: -1
      name: Verify the name was changed
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "66"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Endpoint
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: PaloAltoNetworksXDR.Endpoint.endpoint_id
                      iscontext: true
                    right:
                      value:
                        simple: aeec6a2cc92e46fab3b6f621722e9916
                accessor: alias
            iscontext: true
          right:
            value:
              simple: testing
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "65":
    id: "65"
    taskid: 44d63978-7a57-4349-850e-58feccfc7038
    type: regular
    task:
      id: 44d63978-7a57-4349-850e-58feccfc7038
      version: -1
      name: Get endpoint
      description: Gets a list of endpoints, according to the passed filters. If there
        are no filters, all endpoints are returned. Filtering by multiple fields will
        be concatenated using AND condition (OR is not supported). Maximum result
        set size is 100. Offset is the zero-based number of endpoint from the start
        of the result set (start by counting from 0).
      script: '|||xdr-get-endpoints'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "64"
    scriptarguments:
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "66":
    id: "66"
    taskid: 7963fc13-833a-4645-84a9-29b859a11b60
    type: regular
    task:
      id: 7963fc13-833a-4645-84a9-29b859a11b60
      version: -1
      name: Change alias name to the original name
      description: Gets a list of endpoints according to the passed filters, and changes
        their alias name. Filtering by multiple fields will be concatenated using
        the AND condition (OR is not supported).
      script: '|||xdr-endpoint-alias-change'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "67"
    scriptarguments:
      alias_name:
        complex:
          root: old_name
      endpoint_id_list:
        simple: aeec6a2cc92e46fab3b6f621722e9916
      new_alias_name:
        simple: testing
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: ffe9488e-8d6c-4a8c-8836-f195b334e03d
    type: regular
    task:
      id: ffe9488e-8d6c-4a8c-8836-f195b334e03d
      version: -1
      name: xdr-list-users
      description: Retrieve a list of the current users in your environment.
      script: '|||xdr-list-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "68"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: e75f96ea-4bf3-45b0-8d9d-f4a8fc9298f8
    type: condition
    task:
      id: e75f96ea-4bf3-45b0-8d9d-f4a8fc9298f8
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "72"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: in
          left:
            value:
              simple: Adi
          right:
            value:
              simple: PaloAltoNetworksXDR.User.user_first_name
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 11890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "72":
    id: "72"
    taskid: 1fed4ad8-2701-486d-8c92-aa7490ea91a9
    type: regular
    task:
      id: 1fed4ad8-2701-486d-8c92-aa7490ea91a9
      version: -1
      name: xdr-list-risky-users
      description: Retrieve the risk score of a specific user or list of users with
        the highest risk score in your environment along with the reason affecting
        each score.
      script: '|||xdr-list-risky-users'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "83"
    scriptarguments:
      limit:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "76":
    id: "76"
    taskid: 647be8a6-beab-4c58-8ab6-0b209f2f2102
    type: regular
    task:
      id: 647be8a6-beab-4c58-8ab6-0b209f2f2102
      version: -1
      name: xdr-list-risky-hosts
      description: Retrieve the risk score of a specific host or list of hosts with
        the highest risk score in your environment along with the reason affecting
        each score.
      script: '|||xdr-list-risky-hosts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
    scriptarguments:
      limit:
        simple: "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "77":
    id: "77"
    taskid: 6e85e18c-0d58-4e00-8876-5387637dbca9
    type: condition
    task:
      id: 6e85e18c-0d58-4e00-8876-5387637dbca9
      version: -1
      name: Assert wasnt returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "85"
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "78":
    id: "78"
    taskid: 4ff26a11-0d1b-4307-890f-ed5a62c12dad
    type: regular
    task:
      id: 4ff26a11-0d1b-4307-890f-ed5a62c12dad
      version: -1
      name: xdr-list-roles
      description: Retrieve information about one or more roles created in your environment.
      script: '|||xdr-list-roles'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      role_names:
        simple: Admin
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13115
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "79":
    id: "79"
    taskid: 1f5affc5-807c-43b5-8e63-48e0fcfd91b4
    type: condition
    task:
      id: 1f5affc5-807c-43b5-8e63-48e0fcfd91b4
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "24"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: PaloAltoNetworksXDR.Role
                accessor: pretty_name
            iscontext: true
          right:
            value:
              simple: Admin
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 13290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: 1af3653c-6a6a-4d7d-8e58-31e9fb1fe359
    type: regular
    task:
      id: 1af3653c-6a6a-4d7d-8e58-31e9fb1fe359
      version: -1
      name: get-correlation-alerts
      description: "Returns a list of alerts and their metadata, which you can filter
        by built-in arguments or use the custom_filter to input a JSON filter object.
        \nMultiple filter arguments will be concatenated using the AND operator, while
        arguments that support a comma-separated list of values will use an OR operator
        between each value."
      script: '|||xdr-get-alerts'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      alert_source:
        simple: correlation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "82":
    id: "82"
    taskid: fe606d1f-ce9a-4372-8e99-654d993e4fe7
    type: condition
    task:
      id: fe606d1f-ce9a-4372-8e99-654d993e4fe7
      version: -1
      name: check if have any correlation alerts
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: PaloAltoNetworksXDR.Alert.internal_id
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 6805a73a-33ed-476d-8b7e-b8ae2b64369a
    type: condition
    task:
      id: 6805a73a-33ed-476d-8b7e-b8ae2b64369a
      version: -1
      name: Verify outputs if exists
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser.score
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 12240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 5516aea8-3fe0-4eaf-871e-8a31d6f9bb34
    type: condition
    task:
      id: 5516aea8-3fe0-4eaf-871e-8a31d6f9bb34
      version: -1
      name: Assert wasnt returned
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "76"
    separatecontext: false
    defaultassigneecomplex:
      simple: ${PaloAltoNetworksXDR.RiskyUser}
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyUser
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 12415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 4cde71e7-da27-4ab5-8b79-93a389da1de6
    type: condition
    task:
      id: 4cde71e7-da27-4ab5-8b79-93a389da1de6
      version: -1
      name: Assert schema
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "78"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.type
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.id
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: PaloAltoNetworksXDR.RiskyHost.score
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 275,
          "y": 12940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "87":
    id: "87"
    taskid: 840daca3-ac1f-41d5-8cc4-719997c68593
    type: regular
    task:
      id: 840daca3-ac1f-41d5-8cc4-719997c68593
      version: -1
      name: xdr-update-incident-including-alerts
      description: Updates one or more fields of a specified incident. Missing fields
        will be ignored. To remove the assignment for an incident, pass a null value
        in the assignee email argument.
      script: '|||xdr-update-incident'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
      resolve_alerts:
        simple: "true"
      resolve_comment:
        simple: i am resolved
      status:
        simple: RESOLVED_DUPLICATE
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "88":
    id: "88"
    taskid: 4f3034dd-7ae3-4414-8322-6855d91912c3
    type: regular
    task:
      id: 4f3034dd-7ae3-4414-8322-6855d91912c3
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      alerts_limit:
        simple: "1"
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3695
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "89":
    id: "89"
    taskid: 289de679-05a7-4929-89d9-5dfc1ff72297
    type: regular
    task:
      id: 289de679-05a7-4929-89d9-5dfc1ff72297
      version: -1
      name: xdr-update-alert
      description: |-
        Update one or more alerts with the provided arguments.
        Required license: Cortex XDR Prevent, Cortex XDR Pro per Endpoint, or Cortex XDR Pro per GB.
      script: '|||xdr-update-alert'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "92"
    scriptarguments:
      alert_ids:
        complex:
          root: PaloAltoNetworksXDR.Incident.alerts
          accessor: alert_id
          transformers:
          - operator: FirstArrayElement
      comment:
        simple: i was updated from playbook
      severity:
        simple: low
      status:
        simple: under_investigation
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "90":
    id: "90"
    taskid: c9c8af13-d3a2-4a11-8884-af2d9349654e
    type: regular
    task:
      id: c9c8af13-d3a2-4a11-8884-af2d9349654e
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      alerts_limit:
        simple: "1"
      incident_id:
        simple: ${PaloAltoNetworksXDR.Incident.incident_id}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3345
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "91":
    id: "91"
    taskid: 5e359824-d9f4-42ad-8aa2-0624fbbd75fc
    type: condition
    task:
      id: 5e359824-d9f4-42ad-8aa2-0624fbbd75fc
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "88"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.incident_id
            iscontext: true
          right:
            value:
              complex:
                root: PaloAltoNetworksXDR.Incident
                accessor: incident_id
                transformers:
                - operator: FirstArrayElement
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.status
            iscontext: true
          right:
            value:
              simple: resolved_duplicate
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.resolve_comment
            iscontext: true
          right:
            value:
              simple: i am resolved
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.alerts.[0].resolution_comment
            iscontext: true
          right:
            value:
              simple: resolved by XSOAR, due to incident 85 has been resolved
      - - operator: isEqualString
          left:
            value:
              simple: PaloAltoNetworksXDR.Incident.alerts.[0].resolution_status
            iscontext: true
          right:
            value:
              simple: STATUS_050_RESOLVED_DUPLICATE
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "92":
    id: "92"
    taskid: fd9c9bf4-dcee-411e-8947-5ad52052ecd1
    type: regular
    task:
      id: fd9c9bf4-dcee-411e-8947-5ad52052ecd1
      version: -1
      name: xdr-get-incident-extra-data
      description: Returns additional data for the specified incident, for example,
        related alerts, file artifacts, network artifacts, and so on.
      script: '|||xdr-get-incident-extra-data'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "93"
    scriptarguments:
      incident_id:
        complex:
          root: PaloAltoNetworksXDR.Incident
          accessor: incident_id
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4045
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "93":
    id: "93"
    taskid: 4fef2620-095b-4dbc-861b-08d272c30657
    type: condition
    task:
      id: 4fef2620-095b-4dbc-861b-08d272c30657
      version: -1
      name: Verify Outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.[0].severity}
            iscontext: true
          right:
            value:
              simple: low
      - - operator: isEqualString
          left:
            value:
              simple: ${PaloAltoNetworksXDR.Incident.alerts.[0].resolution_comment}
            iscontext: true
          right:
            value:
              simple: i was updated from playbook
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 13480,
        "width": 922.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
fromversion: 5.0.0
description: ''
